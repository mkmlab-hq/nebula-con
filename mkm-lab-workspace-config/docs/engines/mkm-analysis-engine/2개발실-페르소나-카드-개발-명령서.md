# 🚀 MKM Lab 개발실 페르소나 카드 개발 명령서 (v3.0)

## 📋 문서 정보
- **버전**: 3.0 (GitHub 생태계 전환)
- **최종 업데이트**: 2024년 12월
- **작성자**: MKM Lab 개발팀
- **승인자**: 프로젝트 총책임자

## 🎯 개발 철학

### **GitHub 중심 생태계**
```
🏗️ 아키텍처: GitHub + GCS 이원화 시스템
├── GitHub: "설계도" 보관소 (코드 + 색인 데이터)
└── GCS: "원자재" 대형 창고 (대용량 데이터)
```

### **핵심 원칙**
1. **GitHub를 유일한 '진실의 원천'으로 설정**
2. **독립 레포지토리 + 중앙 워크스페이스 전략**
3. **GitHub Secrets를 통한 중앙 집중식 API 관리**
4. **GCS는 대용량 데이터 전용 저장소**

## 🏗️ 프로젝트 아키텍처

### **저장소 구조**
```
📁 F:\workspace\ (중앙 워크스페이스)
├── 📁 mkm-analysis-engine/ (핵심 분석 엔진)
├── 📁 persona-diary-frontend/ (페르소나 일기 프론트엔드)
├── 📁 chart-assistant/ (차트 어시스턴트)
├── 📁 mkm-inst-web/ (웹 인스턴스)
└── 📁 mkm-med-platform/ (의료 플랫폼)
```

### **데이터 분산 전략**
| 데이터 유형 | 저장 위치 | 크기 | 접근 빈도 | 관리 방식 |
|------------|-----------|------|-----------|-----------|
| **소스 코드** | GitHub | ~50MB | 높음 | Git 버전 관리 |
| **색인 데이터** | GitHub | 1.57MB | 높음 | 코드와 함께 관리 |
| **실제 논문** | GCS | 수십GB | 중간 | 대용량 저장소 |
| **미디어 파일** | GCS | 수백MB | 낮음 | 참조용 저장 |

## 🔧 개발 환경 설정

### **1. 로컬 환경 구성**
```bash
# 1. 중앙 워크스페이스 생성
mkdir F:\workspace
cd F:\workspace

# 2. 독립 레포지토리 클론
git clone https://github.com/mkmlab-hq/mkm-analysis-engine.git
git clone https://github.com/mkmlab-hq/persona-diary-frontend.git
git clone https://github.com/mkmlab-hq/chart-assistant.git
# ... 기타 레포지토리

# 3. 환경 변수 설정
cp mkm-analysis-engine/env.example mkm-analysis-engine/.env
# .env 파일에 실제 API 키 입력
```

### **2. GitHub Secrets 설정**
각 레포지토리의 Settings > Secrets and variables > Actions에서 설정:

**필수 Secrets:**
- `OPENAI_API_KEY`: OpenAI API 키
- `GOOGLE_AI_API_KEY`: Google AI API 키
- `GEMINI_API_KEY`: Gemini API 키
- `TELEGRAM_BOT_TOKEN`: 텔레그램 봇 토큰
- `MKM_API_KEY`: MKM API 키
- `ENABLE_GCS_UPLOAD`: GCS 업로드 활성화 여부
- `GCS_BUCKET_NAME`: GCS 버킷 이름
- `GCP_PROJECT_ID`: GCP 프로젝트 ID

## 📊 데이터 관리 전략

### **GitHub 데이터 (설계도)**
```
📁 mkm-analysis-engine/
├── 📄 constitution_with_embedding.json (721KB)
├── 📄 data_for_vertex.jsonl (846KB)
├── 📄 소스 코드
└── 📄 설정 파일
```

### **GCS 데이터 (원자재)**
```
📦 mkm-knowledge-base-bucket/
├── 📄 실제 논문 데이터 (수만 편)
├── 📊 대용량 분석 결과
├── 🖼️ 미디어 파일
└── 📚 PDF 원본 파일
```

## 🔄 개발 워크플로우

### **일일 작업 프로세스**
```bash
# 1. 최신 코드 동기화
cd F:\workspace\mkm-analysis-engine
git pull origin main

# 2. 개발 작업 수행
# - 코드 수정
# - 기능 개발
# - 테스트 실행

# 3. 변경사항 커밋 및 푸시
git add .
git commit -m "FEAT: 새로운 기능 추가"
git push origin main
```

### **GitHub Actions 자동화**
```yaml
# .github/workflows/main.yml
name: CI/CD Pipeline
on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  test-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v4
      - name: Run tests
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          GOOGLE_AI_API_KEY: ${{ secrets.GOOGLE_AI_API_KEY }}
        run: python -m pytest
```

## 🎨 페르소나 카드 개발 가이드

### **카드 생성 프로세스**
1. **데이터 수집**: AI 연구 데이터 수집기 실행
2. **분석 처리**: 페르소나 분석 알고리즘 적용
3. **카드 생성**: 템플릿 기반 카드 생성
4. **품질 검증**: 자동화된 품질 체크
5. **배포**: GitHub Actions를 통한 자동 배포

### **카드 템플릿 구조**
```json
{
  "id": "unique_card_id",
  "title": "카드 제목",
  "description": "카드 설명",
  "persona_type": "persona_category",
  "attributes": {
    "strength": 85,
    "intelligence": 90,
    "creativity": 75
  },
  "metadata": {
    "created_at": "2024-12-01T00:00:00Z",
    "source": "ai_research_data",
    "version": "3.0"
  }
}
```

## 🔒 보안 및 품질 관리

### **코드 품질 기준**
- **Python**: PEP 8 준수, 타입 힌트 사용
- **JavaScript**: ESLint 규칙 준수
- **테스트 커버리지**: 80% 이상 유지
- **문서화**: 모든 함수에 docstring 작성

### **데이터 품질 관리**
- **허위 데이터 제거**: 자동화된 정화 스크립트
- **중복 데이터 제거**: 해시 기반 중복 검사
- **데이터 검증**: 스키마 기반 유효성 검사
- **백업 관리**: 정기적인 GCS 백업

### **보안 정책**
- **API 키 관리**: GitHub Secrets 사용
- **접근 제어**: IAM 역할 기반 권한 관리
- **암호화**: 모든 데이터 기본 암호화
- **감사 로그**: 모든 접근 기록 유지

## 📈 성능 최적화

### **GitHub 최적화**
- **저장소 크기**: 1GB 이하 유지
- **파일 크기**: 100MB 이하 파일만 커밋
- **히스토리 관리**: 정기적인 히스토리 정리

### **GCS 최적화**
- **스토리지 클래스**: 접근 빈도에 따른 최적화
- **캐싱**: 자주 접근하는 데이터 캐싱
- **압축**: 대용량 파일 압축 저장

## 🚀 배포 및 운영

### **배포 전략**
1. **개발 환경**: 로컬 개발 및 테스트
2. **스테이징 환경**: GitHub Actions 자동 테스트
3. **프로덕션 환경**: 승인 후 자동 배포

### **모니터링**
- **GitHub**: 저장소 크기, 커밋 빈도 모니터링
- **GCS**: 사용량, 비용, 접근 패턴 모니터링
- **애플리케이션**: 성능, 오류, 사용자 활동 모니터링

## 📚 참고 자료

### **핵심 문서**
- [GitHub 생태계 전환 가이드](./GITHUB_CENTRIC_DATA_STRATEGY.md)
- [최종 아키텍처 계획](./FINAL_ARCHITECTURE_PLAN.md)
- [GCS 데이터 업로드 전략](./GCS_DATA_UPLOAD_STRATEGY.md)

### **API 문서**
- [OpenAI API 문서](https://platform.openai.com/docs)
- [Google AI API 문서](https://ai.google.dev/docs)
- [GCS API 문서](https://cloud.google.com/storage/docs)

### **도구 및 라이브러리**
- **Python**: pandas, numpy, openai, google-cloud-storage
- **JavaScript**: Vue.js, Node.js, axios
- **DevOps**: GitHub Actions, Docker, gsutil

## 🎯 성공 지표

### **기술적 지표**
- 📊 **GitHub 저장소 크기**: 1GB 이하 유지
- ⚡ **빌드 시간**: 5분 이하
- 🛡️ **보안 사고**: 0건
- 🔄 **배포 성공률**: 99% 이상

### **비즈니스 지표**
- 📈 **페르소나 카드 생성**: 일 1000개 이상
- 💰 **운영 비용**: 월 $50 이하
- 📊 **데이터 품질**: 99.9% 정확도
- 🚀 **시스템 가용성**: 99.9% 이상

---

**이 명령서는 MKM Lab의 모든 개발 활동의 기준이 되며, 정기적으로 검토하고 업데이트됩니다.**

**마지막 업데이트: 2024년 12월**
**다음 검토 예정: 2025년 3월** 