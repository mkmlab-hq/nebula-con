# .github/workflows/ci.yml
# NebulaCon CI: ì²« ìë™í™” ë¶€ëŒ€ì˜ ê²¬ê³ í•œ í† ëŒ€
#
# - í˜„ì¬ëŠ” êµ¬ì¡° ê²€ì¦ì— ì§‘ì¤‘, ë¯¸ë˜ì—” Python í’ˆì§ˆê²€ì‚¬ë¡œ í™•ì¥
# - ê° ë‹¨ê³„ì— ì„¤ëª… ì¶”ê°€, ì‹¤íŒ¨ ì‹œ GitHub Actions Summaryì—ë„ ì›ì¸ ê¸°ë¡

name: NebulaCon CI

on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]
  workflow_dispatch:

jobs:
  structure-check:
    name: "ğŸ§± Repository Structure Check"
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v4

      - name: ğŸ“‚ Verify essential directories
        id: structure
        shell: bash
        run: |
          echo "ğŸ” í•„ìˆ˜ ë””ë ‰í† ë¦¬ ê²€ì‚¬ ì‹œì‘..."
          dirs=(docs scripts sql)
          missing=()
          for d in "${dirs[@]}"; do
            if [ ! -d "$d" ]; then
              echo "::error title=êµ¬ì¡° ì˜¤ë¥˜::âŒ í•„ìˆ˜ ë””ë ‰í† ë¦¬ '$d'ê°€ ì—†ìŠµë‹ˆë‹¤."
              missing+=("$d")
            else
              echo "  - âœ… $d ë””ë ‰í† ë¦¬ ì¡´ì¬"
            fi
          done

          if [ "${#missing[@]}" -ne 0 ]; then
            echo "í•„ìˆ˜ ë””ë ‰í† ë¦¬ ëˆ„ë½: ${missing[*]}" >> $GITHUB_STEP_SUMMARY
            exit 1
          else
            echo "ëª¨ë“  í•„ìˆ˜ ë””ë ‰í† ë¦¬ê°€ ì¡´ì¬í•©ë‹ˆë‹¤." >> $GITHUB_STEP_SUMMARY
          fi
          echo "êµ¬ì¡° ê²€ì‚¬ ì™„ë£Œ."

  # --- ì•„ë˜ëŠ” ì½”ë“œ ì¶”ê°€ ì‹œ ì£¼ì„ í•´ì œí•˜ì—¬ í™•ì¥ ê°€ëŠ¥ ---
  # python-ci:
  #   name: "ğŸ Python CI"
  #   needs: structure-check
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: ğŸ“¥ Checkout repository
  #       uses: actions/checkout@v4
  #
  #     - name: ğŸ Set up Python 3.11
  #       uses: actions/setup-python@v5
  #       with:
  #         python-version: '3.11'
  #
  #     - name: ğŸ“¦ Install dependencies
  #       run: |
  #         python -m pip install --upgrade pip
  #         if [ -f requirements.txt ]; then pip install -e ".[dev]"; fi
  #
  #     - name: ğŸ§¹ Lint with Ruff
  #       run: |
  #         pip install ruff
  #         ruff check .
  #
  #     - name: ğŸ§ª Run tests with Pytest
  #       run: |
  #         pip install pytest pytest-cov
  #         pytest --maxfail=3 --disable-warnings --cov=.
